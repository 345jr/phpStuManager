import{r as u,f as m,c as r,a as t,t as s,F as x,h as y,g as d,l as v,o as n}from"./index-CkDlZFGI.js";const f={class:"bg-gray-100 min-h-screen py-8 px-4 sm:px-6 lg:px-8"},b={class:"max-w-4xl mx-auto"},w={class:"bg-white shadow-md rounded-lg p-6 mb-8 flex items-center space-x-6"},C=["src"],k={class:"text-2xl font-bold text-gray-800"},I={class:"text-gray-600"},S={class:"text-gray-600"},B={class:"bg-white shadow-md rounded-lg p-6"},j={key:0,class:"space-y-4"},E={class:"text-lg font-semibold text-gray-800"},F={class:"text-sm text-gray-500"},L={class:"text-sm text-gray-500"},M=["onClick"],D={key:1,class:"text-center text-gray-500"},$={__name:"Me",setup(N){const h=v(),l=u([]),a=u({}),i=async()=>{try{const e=await d.get("/api/enrolledCourses",{withCredentials:!0});l.value=e.data,console.log(l.value)}catch(e){console.error("获取已选课程失败:",e)}},_=async()=>{try{const e=await d.get("/api/studentInfo",{withCredentials:!0});a.value=e.data}catch(e){console.error("获取学生信息失败:",e)}},g=async e=>{try{await d.post("/api/unenroll",{courseId:e}),alert("退课成功"),i()}catch(c){console.error("退课失败:",c),alert("退课失败")}},p=async()=>{try{const e=await d.post("/api/logout",{},{withCredentials:!0});e.status===200?(localStorage.removeItem("token"),localStorage.removeItem("student"),h.push("/")):alert("退出登录失败: "+e.data.message)}catch(e){console.error("退出登录失败:",e),alert("退出登录失败")}};return m(()=>{i(),_()}),(e,c)=>(n(),r("div",f,[t("div",b,[t("div",w,[t("img",{src:a.value.avatar,alt:"学生头像",class:"w-24 h-24 rounded-full object-cover"},null,8,C),t("div",null,[t("h1",k,"姓名 :"+s(a.value.name),1),t("p",I,"学号: "+s(a.value.id),1),t("p",S,"账号: "+s(a.value.email),1)]),t("button",{onClick:p,class:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors"}," 退出登录 ")]),t("div",B,[c[0]||(c[0]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"已选课程",-1)),l.value.length>0?(n(),r("div",j,[(n(!0),r(x,null,y(l.value,o=>(n(),r("div",{key:o.course_id,class:"flex justify-between items-center p-4 bg-gray-50 rounded-md"},[t("div",null,[t("h3",E,"课程名字 :"+s(o.course_name),1),t("p",F,"开课时间: "+s(o.start_time)+" 课时 : "+s(o.class_hour),1),t("p",L,"教师: "+s(o.teacher),1)]),t("button",{onClick:R=>g(o.course_id),class:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors"}," 退课 ",8,M)]))),128))])):(n(),r("div",D,"暂无已选课程"))])])]))}};export{$ as default};
